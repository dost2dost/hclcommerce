{"ast":null,"code":"/* @license\n * Copyright 2020 Google LLC. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the 'License');\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an 'AS IS' BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar _a;\n\nimport { getLocallyUniqueId } from '../../utilities.js';\nexport const $relatedObject = Symbol('relatedObject');\nexport const $type = Symbol('type');\nconst $graft = Symbol('graft');\nconst $id = Symbol('id');\n/**\n * A SerializableThreeDOMElement is the common primitive of all scene graph\n * elements that have been facaded in the host execution context. It adds\n * a common interface to these elements in support of convenient\n * serializability.\n */\n\nexport class ThreeDOMElement {\n  constructor(graft, relatedObject) {\n    this[_a] = getLocallyUniqueId();\n    this[$relatedObject] = relatedObject;\n    this[$graft] = graft;\n    graft.adopt(this);\n  }\n  /**\n   * The Model of provenance for this scene graph element.\n   */\n\n\n  get ownerModel() {\n    return this[$graft].model;\n  }\n  /**\n   * The unique ID that marks this element. In generally, an ID should only be\n   * considered unique to the element in the context of its scene graph. These\n   * IDs are not guaranteed to be stable across script executions.\n   */\n\n\n  get internalID() {\n    return this[$id];\n  }\n  /**\n   * Some (but not all) scene graph elements may have an optional name. The\n   * Object3D.prototype.name property is sometimes auto-generated by Three.js.\n   * We only want to expose a name that is set in the source glTF, so Three.js\n   * generated names are ignored.\n   */\n\n\n  get name() {\n    const relatedObject = this[$relatedObject]; // NOTE: Some Three.js object names are modified from the names found in the\n    // glTF. Special casing is handled here, but might be better moved to\n    // subclasses down the road:\n\n    if (relatedObject.isMaterial) {\n      // Material names can be safely referenced directly from the Three.js\n      // object.\n      // @see: https://github.com/mrdoob/three.js/blob/790811db742ea9d7c54fe28f83865d7576f14134/examples/js/loaders/GLTFLoader.js#L2162\n      return relatedObject.name;\n    }\n\n    return null;\n  }\n  /**\n   * The backing Three.js scene graph construct for this element.\n   */\n\n\n  get relatedObject() {\n    return this[$relatedObject];\n  }\n\n  toJSON() {\n    const serialized = {\n      id: this[$id]\n    };\n    const name = this.name;\n\n    if (name != null) {\n      serialized.name = name;\n    }\n\n    return serialized;\n  }\n\n}\n_a = $id;","map":{"version":3,"sources":["../../../src/facade/three-js/three-dom-element.ts"],"names":[],"mappings":"AAAA;;;;;;;;;;;;;;;;AAmBA,SAAQ,kBAAR,QAAiC,oBAAjC;AAKA,OAAO,MAAM,cAAc,GAAG,MAAM,CAAC,eAAD,CAA7B;AACP,OAAO,MAAM,KAAK,GAAG,MAAM,CAAC,MAAD,CAApB;AAEP,MAAM,MAAM,GAAG,MAAM,CAAC,OAAD,CAArB;AACA,MAAM,GAAG,GAAG,MAAM,CAAC,IAAD,CAAlB;AAEA;;;;;;;AAMA,OAAM,MAAO,eAAP,CAAsB;AAM1B,EAAA,WAAA,CAAY,KAAZ,EAA+B,aAA/B,EAAoE;AAF7D,SAAA,EAAA,IAAgB,kBAAkB,EAAlC;AAGL,SAAK,cAAL,IAAuB,aAAvB;AACA,SAAK,MAAL,IAAe,KAAf;AAEA,IAAA,KAAK,CAAC,KAAN,CAAY,IAAZ;AACD;AAED;;;;;AAGA,MAAI,UAAJ,GAAc;AACZ,WAAO,KAAK,MAAL,EAAa,KAApB;AACD;AAED;;;;;;;AAKA,MAAI,UAAJ,GAAc;AACZ,WAAO,KAAK,GAAL,CAAP;AACD;AAED;;;;;;;;AAMA,MAAI,IAAJ,GAAQ;AACN,UAAM,aAAa,GAAG,KAAK,cAAL,CAAtB,CADM,CAGN;AACA;AACA;;AACA,QAAK,aAA0B,CAAC,UAAhC,EAA4C;AAC1C;AACA;AACA;AACA,aAAQ,aAA0B,CAAC,IAAnC;AACD;;AAED,WAAO,IAAP;AACD;AAED;;;;;AAGA,MAAI,aAAJ,GAAiB;AACf,WAAO,KAAK,cAAL,CAAP;AACD;;AAED,EAAA,MAAM,GAAA;AACJ,UAAM,UAAU,GAA8B;AAAC,MAAA,EAAE,EAAE,KAAK,GAAL;AAAL,KAA9C;AADI,UAEG,IAFH,GAEW,IAFX,CAEG,IAFH;;AAGJ,QAAI,IAAI,IAAI,IAAZ,EAAkB;AAChB,MAAA,UAAU,CAAC,IAAX,GAAkB,IAAlB;AACD;;AACD,WAAO,UAAP;AACD;;AAjEyB;KAIlB,G","sourcesContent":["/* @license\n * Copyright 2020 Google LLC. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the 'License');\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an 'AS IS' BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {Material, Object3D} from 'three';\nimport {GLTF} from 'three/examples/jsm/loaders/GLTFLoader.js';\n\nimport {SerializedThreeDOMElement} from '../../protocol.js';\nimport {getLocallyUniqueId} from '../../utilities.js';\nimport {ThreeDOMElement as ThreeDOMElementInterface} from '../api.js';\n\nimport {ModelGraft} from './model-graft.js';\n\nexport const $relatedObject = Symbol('relatedObject');\nexport const $type = Symbol('type');\n\nconst $graft = Symbol('graft');\nconst $id = Symbol('id');\n\n/**\n * A SerializableThreeDOMElement is the common primitive of all scene graph\n * elements that have been facaded in the host execution context. It adds\n * a common interface to these elements in support of convenient\n * serializability.\n */\nexport class ThreeDOMElement implements ThreeDOMElementInterface {\n  private[$graft]: ModelGraft;\n  private[$relatedObject]: Object3D|Material|GLTF;\n\n  private[$id]: number = getLocallyUniqueId();\n\n  constructor(graft: ModelGraft, relatedObject: Object3D|Material|GLTF) {\n    this[$relatedObject] = relatedObject;\n    this[$graft] = graft;\n\n    graft.adopt(this);\n  }\n\n  /**\n   * The Model of provenance for this scene graph element.\n   */\n  get ownerModel() {\n    return this[$graft].model;\n  }\n\n  /**\n   * The unique ID that marks this element. In generally, an ID should only be\n   * considered unique to the element in the context of its scene graph. These\n   * IDs are not guaranteed to be stable across script executions.\n   */\n  get internalID() {\n    return this[$id];\n  }\n\n  /**\n   * Some (but not all) scene graph elements may have an optional name. The\n   * Object3D.prototype.name property is sometimes auto-generated by Three.js.\n   * We only want to expose a name that is set in the source glTF, so Three.js\n   * generated names are ignored.\n   */\n  get name() {\n    const relatedObject = this[$relatedObject];\n\n    // NOTE: Some Three.js object names are modified from the names found in the\n    // glTF. Special casing is handled here, but might be better moved to\n    // subclasses down the road:\n    if ((relatedObject as Material).isMaterial) {\n      // Material names can be safely referenced directly from the Three.js\n      // object.\n      // @see: https://github.com/mrdoob/three.js/blob/790811db742ea9d7c54fe28f83865d7576f14134/examples/js/loaders/GLTFLoader.js#L2162\n      return (relatedObject as Material).name;\n    }\n\n    return null;\n  }\n\n  /**\n   * The backing Three.js scene graph construct for this element.\n   */\n  get relatedObject() {\n    return this[$relatedObject];\n  }\n\n  toJSON(): SerializedThreeDOMElement {\n    const serialized: SerializedThreeDOMElement = {id: this[$id]};\n    const {name} = this;\n    if (name != null) {\n      serialized.name = name;\n    }\n    return serialized;\n  }\n}\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}